---
- name: Install/uninstall packages (RedHat)
  yum:
    name: "{{ item.key }}"
    state: "{{ item.value }}"
  loop: "{{ lookup('template', 'packages.yml.j2') | from_yaml | dict2items }}"
  when: ansible_os_family == "RedHat"

- name: Install/uninstall packages (Debian)
  apt:
    name: "{{ item.key }}"
    state: "{{ item.value }}"
  loop: "{{ lookup('template', 'packages.yml.j2') | from_yaml | dict2items }}"
  when: ansible_os_family == "Debian"
